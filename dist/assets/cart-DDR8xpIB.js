import{n as p,r as u,a2 as c}from"./index-DTjOUT29.js";import{a as n}from"./api-D0beKIRp.js";const f=t=>n.post("/cart",{data:t}),g=()=>n.get("/cart"),C=(t,a)=>n.put(`/cart/${t}`,a),v=t=>n.delete(`/cart/${t}`),m=t=>n.post("/coupon",t),E=p("cart",()=>{const t=u([]),a=u(!1),l=u({}),i=u(""),d=()=>{t.value=[],l.value={},i.value=""},y=async(r,e)=>{a.value=!0;try{const s=await f(r,e);s.success?await o():c({type:"error",message:s.message})}catch(s){console.error(s)}finally{a.value=!1}},o=async()=>{var r,e;a.value=!0;try{const s=await g();t.value=s.data.carts,l.value=s.data,i.value=((e=(r=t.value[0])==null?void 0:r.coupon)==null?void 0:e.code)||""}catch(s){console.log(s)}finally{a.value=!1}};return{cartList:t,cartData:l,couponCode:i,clearCart:d,addToCart:y,deleteCartProduct:async r=>{a.value=!0;try{const e=await v(r);e.success?await o():c({type:"error",message:e.message})}catch(e){console.error(e)}finally{a.value=!1}},getCartProducts:o,editCartProduct:async r=>{a.value=!0;try{const e=await C(r.id,{data:{product_id:r.product_id,qty:r.qty}});e.success?await o():c({type:"error",message:e.message})}catch(e){console.error(e)}finally{a.value=!1}},getCoupon:async r=>{try{const e=await m({data:{code:r}});e.success?(c({type:"success",message:"已成功使用折價券"}),await o()):c({type:"error",message:e.message})}catch(e){console.error(e)}}}});export{E as u};
